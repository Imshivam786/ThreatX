<div class="add-system-container">
  <mat-card class="form-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>add_circle</mat-icon>
        Add New System to Monitor
      </mat-card-title>
      <mat-card-subtitle>
        Configure a new system for OSINT-based threat detection
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="systemForm" (ngSubmit)="onSubmit()">
        
        <!-- System Information Section -->
        <h3 class="section-title">System Information</h3>
        
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Local Name</mat-label>
          <input matInput formControlName="localName" placeholder="e.g., SCADA-HMI-01">
          <mat-icon matPrefix>label</mat-icon>
          <mat-error *ngIf="systemForm.get('localName')?.hasError('required')">
            Name is required
          </mat-error>
          <mat-error *ngIf="systemForm.get('localName')?.hasError('minlength')">
            Name must be at least 3 characters
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>IP Address</mat-label>
          <input matInput formControlName="ipAddress" placeholder="192.168.1.100">
          <mat-icon matPrefix>wifi</mat-icon>
          <mat-error *ngIf="systemForm.get('ipAddress')?.hasError('required')">
            IP Address is required
          </mat-error>
          <mat-error *ngIf="systemForm.get('ipAddress')?.hasError('pattern')">
            Invalid IP Address format
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>System Type</mat-label>
          <mat-select formControlName="systemType">
            <mat-option *ngFor="let type of systemTypes" [value]="type">
              {{ type }}
            </mat-option>
          </mat-select>
          <mat-icon matPrefix>category</mat-icon>
          <mat-error *ngIf="systemForm.get('systemType')?.hasError('required')">
            System type is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description (Optional)</mat-label>
          <textarea matInput formControlName="description" rows="3" placeholder="Additional information about this system"></textarea>
          <mat-icon matPrefix>description</mat-icon>
        </mat-form-field>

        <!-- SSH Connection Section -->
        <h3 class="section-title">SSH Connection Details</h3>

        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>SSH Username</mat-label>
            <input matInput formControlName="sshUsername" placeholder="root">
            <mat-icon matPrefix>person</mat-icon>
            <mat-error *ngIf="systemForm.get('sshUsername')?.hasError('required')">
              Username is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>SSH Port</mat-label>
            <input matInput type="number" formControlName="sshPort" placeholder="22">
            <mat-icon matPrefix>settings_ethernet</mat-icon>
            <mat-error *ngIf="systemForm.get('sshPort')?.hasError('required')">
              Port is required
            </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>SSH Password</mat-label>
          <input matInput type="password" formControlName="sshPassword">
          <mat-icon matPrefix>lock</mat-icon>
          <mat-error *ngIf="systemForm.get('sshPassword')?.hasError('required')">
            Password is required
          </mat-error>
        </mat-form-field>

        <!-- Log Configuration Section -->
        <h3 class="section-title">Log Configuration</h3>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Log Path</mat-label>
          <input matInput formControlName="logPath" placeholder="/var/log">
          <mat-icon matPrefix>folder</mat-icon>
          <mat-hint>Path to the log directory on the remote system</mat-hint>
          <mat-error *ngIf="systemForm.get('logPath')?.hasError('required')">
            Log path is required
          </mat-error>
        </mat-form-field>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button mat-button type="button" (click)="onCancel()" [disabled]="submitting">
            <mat-icon>cancel</mat-icon>
            Cancel
          </button>
          <button mat-raised-button color="primary" type="submit" [disabled]="submitting || !systemForm.valid">
            <mat-icon>save</mat-icon>
            {{ submitting ? 'Adding...' : 'Add System' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
